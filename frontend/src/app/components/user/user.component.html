<div class="marg"></div>
<div class="container">
  <div class="row mt-3">
    <div class="col">
      <button type="button" routerLink="/admin-space" class="buttony" id="submitButton1"><h3><i class="fa fa-tags" aria-hidden="true"></i>Return</h3></button>
    </div>
    <div class="col">
      <button type="button" class="buttony" (click)="addUser()" id="submitButton2"><h3><i class="fa fa-th" aria-hidden="true"></i>Add User</h3></button>
    </div>
    <div class="col">
      <button type="button" class="buttony" (click)="showAllUsers()" id="submitButton3"><h3><i class="fa fa-cube" aria-hidden="true"></i>All Users</h3></button>
    </div>
  </div>
</div>



<br />
<div *ngIf="ShowAllUsers"></div>

<div *ngIf="UpdateUser"></div>

<div *ngIf="DeleteUser"></div>

<div *ngIf="ShowUser"></div>




<div class="container login-container" *ngIf="AddUsers">
  <br>
  <br />
  <div class="raw">

    <div class="col-md-16 login-form-1">
      <h1 class="col-5 mx-auto">CREATE NEW USER</h1>

      <form name="form" #u="ngForm" (ngSubmit)="addUser()">

        <div class="form-group">
          <label>First Name :</label>
          <input type="text" name="firstname" class="form-control" placeholder="Your First Name *"
                 ngModel required #fn="ngModel" [(ngModel)]="form.username" [ngModelOptions]="{standalone: true}" />
        </div>
        <div class="alert alert-danger" *ngIf="fn.invalid && fn.touched">
          First Name is a Required Field !
        </div>

        <div class="form-group">
          <label>Last Name :</label>
          <input type="text" name="lastname" class="form-control" placeholder="Your Last Name"
                 ngModele [(ngModel)]="form.lastNameUser" />
        </div>

        <div class="form-group">
          <label>Email :</label>
          <input type="text" name="email" class="form-control" placeholder="Your Email *"
                 ngModel [(ngModel)]="form.emailUser"
                 required #email="ngModel"
                 pattern="[a-zA-Z0-9]+@[a-zA-Z0-9]+.[a-zA-Z0-9]{2,4}" />
          <div class="alert alert-danger" *ngIf="email.invalid && email.touched">
            <div *ngIf="email.errors && email.errors['required']"> Email is a Required Field ! </div>
            <div *ngIf="email.errors && email.errors['pattern']"> Email Invalid </div>
          </div>

          <div class="form-group">
            <label>CIN :</label>
            <input type="text" name="cin" class="form-control" placeholder="Your CIN *"
                   ngModel required #cin="ngModel" [(ngModel)]="form.cinUser" />
          </div>
          <div class="alert alert-danger" *ngIf="cin.invalid && cin.touched">
            CIN is a Required Field !
          </div>

          <div class="form-group">
            <label>Password :</label>
            <input type="password" name="password" class="form-control" placeholder="Your Password *"
                   ngModel required #password="ngModel" [(ngModel)]="form.password"
                   maxlength="20"
                   minlength="8" />
          </div>

          <small id="passwordHelpBlock1" class="form-text">
            Your password must be 8-20 characters long, contain letters and numbers, and must not contain spaces, special characters, or emoji.
          </small>

          <div class="alert alert-danger" *ngIf="password.invalid && password.touched">
            <div *ngIf="password.errors && password.errors['required']"> Password is a Required Field ! </div>
            <div *ngIf="password.errors && password.errors['minlength']"> Password must be more than 8 charactere </div>
          </div>

          <div class="form-group">
            <label>Confirm Password :</label>
            <input type="password" name="confirmpassword" class="form-control" placeholder="Your Confirm Password *"
                   ngModel required #cpassword="ngModel" [(ngModel)]="form.confirmPasswordUser"
                   maxlength="20"
                   minlength="8" />
          </div>
          <small id="passwordHelpBlock" class="form-text">
            Your Confirm password must be equals to password
          </small>

          <div class="alert alert-danger" *ngIf="cpassword.invalid && cpassword.touched">
            <div *ngIf="cpassword.errors && cpassword.errors['required']"> Confirm Your Password ! </div>
            <div *ngIf="cpassword.errors && cpassword.errors['minlength']"> Password must be equals to password </div>
          </div>

          <div class="form-group">
            <label>Phone Number :</label>
            <input type="text" name="phonenumber" class="form-control" placeholder="Your Phone Number *" value=""
                   ngModel [(ngModel)]="form.phoneNumberUser" />
          </div>

          <div class="form-group">
            <label>Address :</label>
            <input type="text" name="address" class="form-control" placeholder="Your Address *" value=""
                   ngModel [(ngModel)]="form.adressUser" />
          </div>

          <div class="form-group">
            <label>Salary :</label>
            <input type="number" name="salary" class="form-control" placeholder="Salary " value=""
                   ngModel [(ngModel)]="form.salaire" />
          </div>

          <div class="form-group">
            <label>Point Number :</label>
            <input type="number" name="pointNumber" class="form-control" placeholder="Point Number " value=""
                   ngModel [(ngModel)]="form.pointNumber" />
          </div>

          <div class="form-group">
            <label>Birth Date :</label>
            <input type="date" name="birthdate" class="form-control" placeholder="Your Birth Date *"
                   ngModel required #birthdate="ngModel" [(ngModel)]="form.birthDateUser" />
          </div>
          <div class="alert alert-danger" *ngIf="birthdate.invalid && birthdate.touched">
            Birth Date is a Required Field !
          </div>

          <div class="form-group">
            <label>Lock Time :</label>
            <input type="date" name="locktime" class="form-control" placeholder="Lock Time *"
                   ngModel [(ngModel)]="form.lockTime" />
          </div>

          <div class="form-group">
            <label>Block Date :</label>
            <input type="date" name="blockdate" class="form-control" placeholder="Block Date *"
                   #blockDate="ngModel" ngModel [(ngModel)]="form.blockDate" />
          </div>

          <div class="form-group">
            <label>Unblock Date :</label>
            <input type="date" name="unblockdate" class="form-control" placeholder="Unblock Date *"
                   #unBlockDate="ngModel" ngModel [(ngModel)]="form.unBlockDate" />
          </div>

          <div class="form-group">
            <label>Reset Token :</label>
            <input type="text" name="locktime" class="form-control" placeholder="Reset Token"
                   #resettoken="ngModel" ngModel [(ngModel)]="form.resettoken" />
          </div>

          <div class="form-group">
            <label>Speciality :</label>
            <select class="form-control" aria-label="Default select example" placeholder="Choose Your speciality" type="text" name="speciality"
                    ngModel [(ngModel)]="form.speciality">
              <option *ngFor="let a of Keyss()">{{a}}</option>
            </select>
          </div>

          <div class="form-group">
            <label>Role :</label>
            <select class="form-control" aria-label="Default select example" placeholder="Role" type="text" name="role"
                    ngModel [(ngModel)]="form.role">
              <option  *ngFor="let c of Keysr()">{{c}}</option>
            </select>
          </div>

          <div class="form-check">
            <input class="form-check-input" type="checkbox" value="" id="flexCheckChecked1" checked [(ngModel)]="form.stateUser">
            <label>State User :</label>
            <label class="form-check-label" for="flexCheckChecked1">
              Actif
            </label>
          </div>

          <div class="form-check">
            <input class="form-check-input" type="checkbox" value="" id="flexCheckChecked2" checked [(ngModel)]="form.isPrivate">
            <label>Is Private ! :</label>
            <label class="form-check-label" for="flexCheckChecked2">
              Yes
            </label>
          </div>

          <div class="form-check">
            <input class="form-check-input" type="checkbox" value="" id="flexCheckChecked3" ngModel [(ngModel)]="form.isBlocked">
            <label>Is Blocked ! :</label>
            <label class="form-check-label" for="flexCheckChecked3">
              Yes
            </label>
          </div>

          <div class="form-check">
            <input class="form-check-input" type="checkbox" value="" id="flexCheckChecked4" checked ngModel [(ngModel)]="form.accountNonLocked">
            <label>Account Non Locked :</label>
            <label class="form-check-label" for="flexCheckChecked4">
              Yes
            </label>
          </div>

          <div class="form-check">
            <input class="form-check-input" type="checkbox" value="" id="flexCheckChecked5" ngModel [(ngModel)]="form.availaibility">
            <label>Availaibility :</label>
            <label class="form-check-label" for="flexCheckChecked5">
              Available
            </label>
          </div>

          <div class="form-group">
            <label  class="form-label">Image</label>
            <input class="form-control" type="file" name="image" placeholder="Your Image"
                   ngModel [(ngModel)]="form.photo">
          </div>

          <div class="d-grid gap-5 col-3 mx-auto">
            <button href="client" [disabled]="u.invalid" (click)="addUser()" type="button" class="btn btn-success btn-lg"> Create Account </button>
          </div>
          <br>
          <br />
          <div class="alert alert-primary">{{msg}}</div>
        </div>
      </form>
    </div>
  </div>
</div>


  <!-- Show All Users-->

<form *ngIf="ShowAllUsers" name="f" (ngSubmit)="showAllUsers()">

  <div class=" col-md-6 col-md-offset-2 custyle">
    <div>
      <input type="text" #myInput [(ngModel)]="username" (input)="Search()" class="form-control" placeholder="Search …">
    </div>
    <table class="table table-striped custab">
      <thead>
        <tr>
          <th>Action</th>

          <th scope="col">Image</th>
          <th scope="col">Id</th>
          <th scope="col">Username</th>
          <th scope="col">F.Name</th>
          <th scope="col">L.Name</th>
          <th scope="col">Role</th>
          <th scope="col">Speciality</th>
          <th scope="col">Status</th>
          <th scope="col">Email</th>
          <th scope="col">Phone</th>
          <th scope="col">BirthDate</th>
          <th scope="col">Country</th>
          <th scope="col">City</th>
          <th scope="col">Address</th>
          <th scope="col">Postal code</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let u of ListUsers">
          <td class="text-center col-3">
            <a (click)="deleteUser(u.id)" class="btn btn-danger btn-xs"><span class="glyphicon glyphicon-remove"></span> Delete</a>
            <br />
            <a (click)="showUser(u)" class="btn btn-primary btn-xs"><span class="glyphicon glyphicon-remove"></span>Show</a>
          </td>
          <img src="{{u.photo}}"
               class="card-img-top">
          <th scope="row"><small>{{u.id}}</small></th>

          <td><small>{{u.username}}</small></td>
          <td><small>{{u.firstName}}</small></td>
          <td><small>{{u.lastName}}</small></td>
          <td><small>{{u.role}}</small></td>
          <td><small>{{u.speciality}}</small></td>
          <td><small>{{u.status}}</small></td>
          <td><small>{{u.email}}</small></td>
          <td><small>{{u.phone}}</small></td>
          <td><small>{{u.birthday}}</small></td>
          <td><small>{{u.country}}</small></td>
          <td><small>{{u.city}}</small></td>
          <td><small>{{u.address}}</small></td>
          <td><small>{{u.postalCode}}</small></td>
        </tr>
      </tbody>
    </table>
  </div>
</form>

  <!-- Update User-->

  <div class="container login-container" *ngIf="ShowUser" >
    <div class="col-md-16 login-form-1">
      <h3 class="col-5 mx-auto">UPDATE THIS USER</h3>
      <form name="forme" #up="ngForm" (ngSubmit)="updateUser()">
        <div class="form-group">
          <input  value="{{user?.id}}" class="form-control" ngModel #id="ngModel" [(ngModel)]="forme.id" />
        </div>
        <div class="form-group">
          <input value="{{user?.username}}" class="form-control" ngModel #un="ngModel" [(ngModel)]="forme.username" />
        </div>
        <div class="form-group">
          <input value="{{user?.firstName}}" class="form-control" ngModel #ln="ngModel" [(ngModel)]="forme.firstName" />
        </div>
        <div class="form-group">
          <input value="{{user?.lastName}}" class="form-control" ngModel #ln="ngModel" [(ngModel)]="forme.lastName" />
        </div>
        <div class="form-group">
          <input value="{{user?.password}}" class="form-control" ngModel #p="ngModel" [(ngModel)]="forme.password" />
        </div>
        <div class="form-group">
          <input value="{{user?.role}}" class="form-control" ngModel #r="ngModel" [(ngModel)]="forme.role" />
        </div>
        <div class="form-group">
          <input value="{{user?.speciality}}" class="form-control" ngModel #zu="ngModel" [(ngModel)]="forme.speciality" />
        </div>
        <div class="form-group">
          <input value="{{user?.status}}" class="form-control" ngModel #ln="ngModel" [(ngModel)]="forme.status" />
        </div>
        <div class="form-group">
          <input value="{{user?.email}}" class="form-control" ngModel #ln="ngModel" [(ngModel)]="forme.email" />
        </div>
        <div class="form-group">
          <input value="{{user?.phone}}" class="form-control" ngModel #pn="ngModel" [(ngModel)]="forme.phone" />
        </div>
        <div class="form-group">
          <input value="{{user?.birthday}}" class="form-control" ngModel #bdu="ngModel" [(ngModel)]="forme.birthday" />
        </div>
        <div class="form-group">
          <input value="{{user?.country}}" class="form-control" ngModel #su="ngModel" [(ngModel)]="forme.country" />
        </div>
        <div class="form-group">
          <input value="{{user?.city}}" class="form-control" ngModel rtu="ngModel" [(ngModel)]="forme.city" />
        </div>
        <div class="form-group">
          <input value="{{user?.address}}" class="form-control" ngModel #au="ngModel" [(ngModel)]="forme.address" />
        </div>
        <div class="form-group">
          <input value="{{user?.postalCode}}" class="form-control" ngModel #ip="ngModel" [(ngModel)]="forme.postalCode" />
        </div>
      </form>
      <div class="d-grid gap-5 col-3 mx-auto">
        <input type="submit" (click)="updateUser()" class="btn btn-success btn-lg" value="Update" />
      </div>
      <br>
      <br />
      <div class="alert alert-primary">{{msg}}</div>
    </div>
  </div>
